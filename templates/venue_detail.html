{% extends 'base.html' %}
{% block title %}{{ venue.name }} • VenueSphere{% endblock %}
{% block content %}
<section class="grid gap-10 lg:grid-cols-[2fr,1fr]">
  <div class="space-y-8">
    <div class="rounded-[3rem] border border-white/10 bg-white/5 p-8 shadow-2xl shadow-slate-950/50 backdrop-blur-2xl">
      <img src="{{ venue.image_url }}" alt="{{ venue.name }}" class="h-80 w-full rounded-3xl object-cover" />
      <div class="mt-6 flex flex-wrap items-start justify-between gap-4">
        <div>
          <p class="text-xs uppercase tracking-[0.4em] text-white/50">{{ venue.category.name }}</p>
          <h1 class="text-4xl font-semibold text-white">{{ venue.name }}</h1>
          <p class="mt-2 text-white/70">{{ venue.city }} • Capacity {{ venue.capacity }} guests</p>
        </div>
        <button data-venue="{{ venue.id }}" class="wishlist-button rounded-full border border-white/20 bg-white/10 p-3 text-white transition hover:bg-white/20" aria-label="Toggle wishlist">
          <svg xmlns="http://www.w3.org/2000/svg" fill="{% if venue.id in wishlist_ids %}currentColor{% else %}none{% endif %}" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-7 w-7">
            <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" />
          </svg>
        </button>
      </div>
      <p class="mt-4 text-white/70">{{ venue.description }}</p>
      <div class="mt-6 grid gap-4 md:grid-cols-2">
        <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
          <h2 class="text-sm font-semibold text-white">Facilities</h2>
          <ul class="mt-2 grid gap-1 text-sm text-white/70">
            {% for facility in venue.facilities_list %}
            <li>• {{ facility }}</li>
            {% endfor %}
          </ul>
        </div>
        <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
          <h2 class="text-sm font-semibold text-white">Location</h2>
          <p class="mt-2 text-sm text-white/70">{{ venue.address|default:'Contact us for the full location details.' }}</p>
        </div>
      </div>
    </div>
    <div class="rounded-[3rem] border border-white/10 bg-white/5 p-8 shadow-2xl shadow-slate-950/50 backdrop-blur-2xl">
      <div class="flex items-center justify-between">
        <h2 class="text-2xl font-semibold text-white">Reviews</h2>
        <span class="text-sm text-white/60">{{ reviews|length }} reviews</span>
      </div>
      <form method="post" class="mt-6 space-y-4">
        {% csrf_token %}
        {{ review_form.non_field_errors }}
        <div class="grid gap-4 md:grid-cols-2">
          <div>
            {{ review_form.rating.label_tag }}
            {{ review_form.rating }}
            {{ review_form.rating.errors }}
          </div>
          <div class="md:col-span-2">
            {{ review_form.comment.label_tag }}
            {{ review_form.comment }}
            {{ review_form.comment.errors }}
          </div>
        </div>
        <button type="submit" name="submit_review" class="rounded-2xl bg-primary px-5 py-3 text-sm font-semibold text-white shadow-lg shadow-cyan-500/30 transition hover:bg-primary/80">Submit review</button>
      </form>
      <div class="mt-8 space-y-4">
        {% for review in reviews %}
        <article class="rounded-2xl border border-white/10 bg-white/5 p-4">
          <div class="flex items-center justify-between">
            <p class="text-sm font-semibold text-white">{{ review.user.username }}</p>
            <p class="text-sm text-white/60">{{ review.rating }}/5</p>
          </div>
          <p class="mt-2 text-sm text-white/70">{{ review.comment }}</p>
          <p class="mt-2 text-xs text-white/50">{{ review.created_at|date:'M d, Y H:i' }}</p>
        </article>
        {% empty %}
        <p class="text-sm text-white/60">No reviews yet. Be the first to share your experience.</p>
        {% endfor %}
      </div>
    </div>
  </div>
  <div class="space-y-8">
    <div class="rounded-[3rem] border border-white/10 bg-white/5 p-8 shadow-2xl shadow-slate-950/50 backdrop-blur-2xl">
      <h2 class="text-2xl font-semibold text-white">Booking details</h2>
      <p class="mt-2 text-white/70">Choose your preferred date, time, and add-ons. Available hours: {{ venue.available_start_time }} - {{ venue.available_end_time }}</p>
      <form method="post" class="mt-6 space-y-4">
        {% csrf_token %}
        {{ booking_form.non_field_errors }}
        <div>
          {{ booking_form.start_datetime.label_tag }}
          {{ booking_form.start_datetime }}
          {{ booking_form.start_datetime.errors }}
        </div>
        <div>
          {{ booking_form.end_datetime.label_tag }}
          {{ booking_form.end_datetime }}
          {{ booking_form.end_datetime.errors }}
        </div>
        <div>
          {{ booking_form.notes.label_tag }}
          {{ booking_form.notes }}
          {{ booking_form.notes.errors }}
        </div>
        <div>
          <h3 class="mb-2 text-sm font-semibold text-white">Enhance your booking</h3>
          {% if booking_form.addons|length %}
          <div class="space-y-2">
            {% for checkbox in booking_form.addons %}
            <label class="flex cursor-pointer items-start gap-3 rounded-2xl border border-white/10 bg-white/5 p-3 text-sm text-white/80 transition hover:border-white/20">
              <span class="mt-1">{{ checkbox.tag }}</span>
              <span class="leading-snug">
                <span class="font-semibold text-white">{{ checkbox.choice_label }}</span>
              </span>
            </label>
            {% endfor %}
          </div>
          {% else %}
          <p class="text-sm text-white/60">No add-ons are available for this venue.</p>
          {% endif %}
          {{ booking_form.addons.errors }}
        </div>
        <button type="submit" class="w-full rounded-2xl bg-primary px-5 py-3 text-base font-semibold text-white shadow-lg shadow-cyan-500/30 transition hover:bg-primary/80">Book this venue</button>
      </form>
    </div>
  </div>
</section>
{% endblock %}
