{% extends 'base.html' %}
{% block title %}Manage Venues • VenueSphere{% endblock %}
{% block content %}
<div
  id="venue-create-modal"
  class="fixed inset-0 z-50 hidden"
  data-modal
  data-modal-initial-focus="{{ venue_form.name.id_for_label }}"
  data-modal-default-open="{{ show_create_modal|yesno:'true,false' }}"
  role="dialog"
  aria-modal="true"
  aria-labelledby="venue-create-title"
  tabindex="-1"
>
  <div class="absolute inset-0 bg-slate-950/70 backdrop-blur-sm" data-modal-close></div>
  <div class="relative mx-auto mt-16 w-full max-w-3xl rounded-[2.5rem] border border-white/10 bg-slate-900/95 p-6 shadow-2xl shadow-slate-950/60">
    <div class="flex items-center justify-between">
      <h2 id="venue-create-title" class="text-2xl font-semibold text-white">List a new venue</h2>
      <button type="button" class="rounded-full border border-white/20 bg-white/10 px-3 py-1 text-lg text-white transition hover:bg-white/20" data-modal-close aria-label="Close">×</button>
    </div>
    <p class="mt-2 text-sm text-white/70">Provide the essential details for the venue. You can add advanced options such as add-ons from the full editor later.</p>
    <form method="post" class="mt-6 space-y-4">
      {% csrf_token %}
      {{ venue_form.non_field_errors }}
      <div class="grid gap-4 md:grid-cols-2">
        {% for field in venue_form %}
        <div class="md:col-span-{% if field.field.widget.attrs.rows %}2{% else %}1{% endif %}">
          <label for="{{ field.id_for_label }}" class="mb-1 block text-sm font-medium text-white/80">{{ field.label }}</label>
          {{ field }}
          {% if field.help_text %}
          <p class="mt-1 text-xs text-white/50">{{ field.help_text }}</p>
          {% endif %}
          {% if field.errors %}
          <p class="mt-1 text-sm text-rose-300">{{ field.errors|striptags }}</p>
          {% endif %}
        </div>
        {% endfor %}
      </div>
      <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
        <p class="text-xs text-white/60">Need to configure add-ons? <a href="{% url 'admin-venue-create' %}" class="font-semibold text-primary transition hover:text-primary/80">Open the advanced editor</a>.</p>
        <button type="submit" class="inline-flex items-center justify-center rounded-2xl bg-primary px-5 py-3 text-sm font-semibold text-white shadow-md shadow-cyan-500/40 transition hover:bg-primary/80">Save venue</button>
      </div>
    </form>
  </div>
</div>
<section class="space-y-8">
  <div class="flex flex-col gap-4 rounded-[2.5rem] border border-white/10 bg-white/5 p-6 shadow-xl shadow-slate-950/40 backdrop-blur-2xl md:flex-row md:items-center md:justify-between">
    <div>
      <h1 class="text-3xl font-semibold text-white">Venue manager</h1>
      <p class="mt-2 text-white/70">Create, update, and curate the venues available for booking.</p>
    </div>
    <a
      href="{% url 'admin-venues' %}?show=create"
      data-modal-target="venue-create-modal"
      class="inline-flex items-center justify-center rounded-2xl bg-primary px-5 py-3 text-sm font-semibold text-white shadow-lg shadow-cyan-500/40 transition hover:bg-primary/80"
      >Add new venue</a
    >
  </div>

  <div class="overflow-hidden rounded-[2rem] border border-white/10 bg-white/5 backdrop-blur-xl">
    <table class="min-w-full divide-y divide-white/5">
      <thead>
        <tr class="text-left text-xs uppercase tracking-widest text-white/60">
          <th class="px-6 py-4">Name</th>
          <th class="px-6 py-4">City</th>
          <th class="px-6 py-4">Category</th>
          <th class="px-6 py-4">Price/hour</th>
          <th class="px-6 py-4">Actions</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-white/5 text-sm text-white/80">
        {% for venue in venues %}
        <tr class="hover:bg-white/5">
          <td class="px-6 py-4 font-semibold text-white">{{ venue.name }}</td>
          <td class="px-6 py-4">{{ venue.city }}</td>
          <td class="px-6 py-4">{{ venue.category.name }}</td>
          <td class="px-6 py-4">Rp {{ venue.price_per_hour }}</td>
          <td class="px-6 py-4">
            <div class="flex flex-wrap gap-2">
              <a href="{% url 'venue-detail' slug=venue.slug %}" class="rounded-xl border border-white/20 px-3 py-1 text-xs text-white transition hover:bg-white/10">View</a>
              <a href="{% url 'admin-venue-edit' venue.pk %}" class="rounded-xl border border-white/20 px-3 py-1 text-xs text-white transition hover:bg-white/10">Edit</a>
              <button
                type="button"
                data-modal-target="delete-venue-{{ venue.pk }}"
                class="rounded-xl border border-rose-300/40 px-3 py-1 text-xs text-rose-200 transition hover:bg-rose-400/20"
              >Delete</button>
            </div>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" class="px-6 py-6 text-center text-white/70">No venues available yet.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  {% if is_paginated %}
  <div class="flex justify-between rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm text-white/80 backdrop-blur-xl">
    {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}" class="rounded-xl px-3 py-1 transition hover:bg-white/10">Previous</a>
    {% else %}
    <span class="rounded-xl px-3 py-1 text-white/40">Previous</span>
    {% endif %}
    <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}" class="rounded-xl px-3 py-1 transition hover:bg-white/10">Next</a>
    {% else %}
    <span class="rounded-xl px-3 py-1 text-white/40">Next</span>
    {% endif %}
  </div>
  {% endif %}
</section>

{% for venue in venues %}
<div
  id="delete-venue-{{ venue.pk }}"
  class="fixed inset-0 z-50 hidden"
  data-modal
  role="dialog"
  aria-modal="true"
  aria-labelledby="delete-venue-{{ venue.pk }}-title"
  tabindex="-1"
>
  <div class="absolute inset-0 bg-slate-950/70 backdrop-blur-sm" data-modal-close></div>
  <div class="relative mx-auto mt-24 w-full max-w-md rounded-[2rem] border border-white/10 bg-slate-900/95 p-6 shadow-2xl shadow-slate-950/60">
    <div class="flex items-center justify-between">
      <h2 id="delete-venue-{{ venue.pk }}-title" class="text-xl font-semibold text-white">Delete {{ venue.name }}?</h2>
      <button type="button" class="rounded-full border border-white/20 bg-white/10 px-3 py-1 text-lg text-white transition hover:bg-white/20" data-modal-close aria-label="Close">×</button>
    </div>
    <p class="mt-3 text-sm text-white/70">This action permanently removes the venue and its availability schedule. Existing bookings will remain intact but new reservations will no longer be possible.</p>
    <div class="mt-6 flex flex-col gap-3 sm:flex-row sm:justify-end">
      <button type="button" class="inline-flex items-center justify-center rounded-2xl border border-white/20 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/10" data-modal-close>Cancel</button>
      <form method="post" action="{% url 'admin-venue-delete' venue.pk %}">
        {% csrf_token %}
        <button type="submit" class="inline-flex items-center justify-center rounded-2xl bg-rose-500 px-4 py-2 text-sm font-semibold text-white shadow-md shadow-rose-500/40 transition hover:bg-rose-400">Delete venue</button>
      </form>
    </div>
  </div>
</div>
{% endfor %}
{% endblock %}
