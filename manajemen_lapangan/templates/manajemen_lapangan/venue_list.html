{% extends 'base.html' %}
<div
  id="admin-venue-modal"
  data-modal
  class="fixed inset-0 z-50 hidden overflow-y-auto bg-slate-950/70 px-4 py-8 backdrop-blur"
  aria-hidden="true"
>
  <div class="mx-auto flex min-h-full max-w-4xl items-center justify-center">
    <div class="w-full rounded-3xl border border-white/15 bg-slate-950/90 p-6 shadow-2xl shadow-slate-950/60">
      <div class="flex items-center justify-between gap-4 border-b border-white/10 pb-4">
        <h2 class="text-xl font-semibold text-white" data-venue-modal-title>Manage venue</h2>
        <button type="button" class="rounded-full border border-white/10 p-2 text-white transition hover:bg-white/10" data-modal-close>
          <span class="sr-only">Close</span>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m6 6 12 12M6 18 18 6" />
          </svg>
        </button>
      </div>
      <div class="mt-4">
        <div class="hidden rounded-xl border border-rose-500/40 bg-rose-500/10 px-4 py-3 text-sm text-rose-100" data-form-error></div>
        <form data-venue-form class="mt-4 space-y-6" novalidate>
          <div class="grid gap-5 md:grid-cols-2">
            {% with field=venue_form.category %}
            <div class="space-y-2 md:col-span-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              {% if field.help_text %}<p class="text-xs text-white/50">{{ field.help_text }}</p>{% endif %}
              <p class="hidden text-sm text-rose-300" data-field-error="category"></p>
            </div>
            {% endwith %}
            {% with field=venue_form.name %}
            <div class="space-y-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              <p class="hidden text-sm text-rose-300" data-field-error="name"></p>
            </div>
            {% endwith %}
            {% with field=venue_form.slug %}
            <div class="space-y-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              <p class="hidden text-sm text-rose-300" data-field-error="slug"></p>
            </div>
            {% endwith %}
            {% with field=venue_form.location %}
            <div class="space-y-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              <p class="hidden text-sm text-rose-300" data-field-error="location"></p>
            </div>
            {% endwith %}
            {% with field=venue_form.city %}
            <div class="space-y-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              <p class="hidden text-sm text-rose-300" data-field-error="city"></p>
            </div>
            {% endwith %}
            {% with field=venue_form.price_per_hour %}
            <div class="space-y-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              {% if field.help_text %}<p class="text-xs text-white/50">{{ field.help_text }}</p>{% endif %}
              <p class="hidden text-sm text-rose-300" data-field-error="price_per_hour"></p>
            </div>
            {% endwith %}
            {% with field=venue_form.capacity %}
            <div class="space-y-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              <p class="hidden text-sm text-rose-300" data-field-error="capacity"></p>
            </div>
            {% endwith %}
            {% with field=venue_form.image_url %}
            <div class="space-y-2 md:col-span-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              <p class="hidden text-sm text-rose-300" data-field-error="image_url"></p>
            </div>
            {% endwith %}
            {% with field=venue_form.available_start_time %}
            <div class="space-y-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              <p class="hidden text-sm text-rose-300" data-field-error="available_start_time"></p>
            </div>
            {% endwith %}
            {% with field=venue_form.available_end_time %}
            <div class="space-y-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              <p class="hidden text-sm text-rose-300" data-field-error="available_end_time"></p>
            </div>
            {% endwith %}
          </div>
          <div class="grid gap-5">
            {% with field=venue_form.description %}
            <div class="space-y-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              <p class="hidden text-sm text-rose-300" data-field-error="description"></p>
            </div>
            {% endwith %}
            {% with field=venue_form.address %}
            <div class="space-y-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              <p class="hidden text-sm text-rose-300" data-field-error="address"></p>
            </div>
            {% endwith %}
            {% with field=venue_form.facilities %}
            <div class="space-y-2">
              <label for="{{ field.id_for_label }}" class="text-sm font-medium text-white">{{ field.label }}</label>
              {{ field }}
              {% if field.help_text %}<p class="text-xs text-white/50">{{ field.help_text }}</p>{% endif %}
              <p class="hidden text-sm text-rose-300" data-field-error="facilities"></p>
            </div>
            {% endwith %}
          </div>
          {% include 'add_on/includes/addon_formset.html' with formset=addon_formset %}
          <div class="flex justify-end gap-3 pt-2">
            <button type="button" class="rounded-xl border border-white/15 px-4 py-2 text-sm text-white transition hover:bg-white/10" data-modal-close>
              Cancel
            </button>
            <button
              type="submit"
              class="inline-flex items-center justify-center rounded-xl bg-primary px-5 py-2 text-sm font-semibold text-white transition hover:bg-primary/80"
              data-venue-submit
            >
              Save venue
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% load static %}
{% block head_extra %}
{{ block.super }}
<script src="{% static 'js/addon-formset.js' %}" defer></script>
<script src="{% static 'js/admin-venues.js' %}" defer></script>
{% endblock %}
{% block title %}Manage Venues â€¢ RagaSpace{% endblock %}
{% block content %}
<section
  class="space-y-8"
  data-admin-venue-app
  data-venues-api-url="{% url 'admin-venues-api' %}"
  data-venue-detail-url-template="{% url 'admin-venue-detail-api' 0 %}"
  data-venue-modal-id="admin-venue-modal"
>
  <div class="flex flex-col gap-4 rounded-[2.5rem] border border-white/10 bg-white/5 p-6 shadow-xl shadow-slate-950/40 backdrop-blur-2xl md:flex-row md:items-center md:justify-between">
    <div>
      <h1 class="text-3xl font-semibold text-white">Venue manager</h1>
      <p class="mt-2 text-white/70">Create, update, and curate the venues available for booking.</p>
    </div>
    <div class="flex flex-col items-center gap-2 md:items-end">
      <a
        href="{% url 'admin-venue-create' %}"
        data-venue-create
        data-modal-target="admin-venue-modal"
        class="inline-flex items-center justify-center rounded-2xl bg-primary px-5 py-3 text-sm font-semibold text-white shadow-lg shadow-cyan-500/40 transition hover:bg-primary/80"
      >
        Add new venue
      </a>
    </div>
  </div>

  <div style="overflow-x: auto;" class="overflow-hidden rounded-[2rem] border border-white/10 bg-white/5 backdrop-blur-xl">
    <table class="min-w-full divide-y divide-white/5">
      <thead>
        <tr class="text-left text-xs uppercase tracking-widest text-white/60">
          <th class="px-6 py-4">Name</th>
          <th class="px-6 py-4">City</th>
          <th class="px-6 py-4">Category</th>
          <th class="px-6 py-4">Price/hour</th>
          <th class="px-6 py-4">Actions</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-white/5 text-sm text-white/80" data-venue-table-body>
        {% for venue in venues %}
        <tr class="hover:bg-white/5" data-venue-row data-venue-id="{{ venue.pk }}">
          <td class="px-6 py-4 font-semibold text-white">{{ venue.name }}</td>
          <td class="px-6 py-4">{{ venue.city }}</td>
          <td class="px-6 py-4">{{ venue.category.name }}</td>
          <td class="px-6 py-4">Rp {{ venue.price_per_hour }}</td>
          <td class="px-6 py-4">
            <div class="flex flex-wrap gap-2">
              <a href="{% url 'venue-detail' slug=venue.slug %}" class="rounded-xl border border-white/20 px-3 py-1 text-xs text-white transition hover:bg-white/10">View</a>
              <a
                href="{% url 'admin-venue-edit' venue.pk %}"
                data-admin-venue-edit
                data-modal-target="admin-venue-modal"
                data-venue-id="{{ venue.pk }}"
                class="rounded-xl border border-white/20 px-3 py-1 text-xs text-white transition hover:bg-white/10"
                >Edit</a
              >
              <form
                method="post"
                action="{% url 'admin-venue-delete' venue.pk %}"
                class="inline"
                data-admin-venue-delete
                data-venue-id="{{ venue.pk }}"
                onsubmit="return confirm('Are you sure you want to delete this venue?');"
              >
                {% csrf_token %}
                <button
                  type="submit"
                  class="rounded-xl border border-rose-300/40 px-3 py-1 text-xs text-rose-200 transition hover:bg-rose-400/20"
                >
                  Delete
                </button>
              </form>
            </div>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" class="px-6 py-6 text-center text-white/70">No venues available yet.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  {% if is_paginated %}
  <div class="flex justify-between rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm text-white/80 backdrop-blur-xl">
    {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}" class="rounded-xl px-3 py-1 transition hover:bg-white/10">Previous</a>
    {% else %}
    <span class="rounded-xl px-3 py-1 text-white/40">Previous</span>
    {% endif %}
    <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}" class="rounded-xl px-3 py-1 transition hover:bg-white/10">Next</a>
    {% else %}
    <span class="rounded-xl px-3 py-1 text-white/40">Next</span>
    {% endif %}
  </div>
  {% endif %}
  <p class="text-xs text-white/50">Use the actions above to keep the venue catalogue up to date.</p>
</section>


{% endblock %}
